<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta name="copyright" content="Copyright (c) 2007, 2012 EclipseSource. This page is made available under license. For full details see the LEGAL in the documentation book that contains this page."/>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <title>Launching RAP Applications from the IDE</title>
  <link rel="stylesheet" href="../../../../PRODUCT_PLUGIN/book.css" type="text/css"/>
</head>
<body>

  <h1>Launching RAP Applications from the IDE</h1>

  <p>
    The RAP Tools provide two dedicated launchers to start RAP applications directly from
    the IDE:
    the <em>RWT Launcher</em>, used for snippets and stand-alone applications, and the
    <em>RAP Launcher</em>, used for applications based on OSGi
    (see <a href = "../advanced/application-setup.html">Choosing an Application Setup</a>
    for these different types of applications).
    OSGi applications can also be started without the RAP Tools, using the plain OSGi Launcher.
  </p>

  <p>
    <b>Contents:</b>
  </p>
  <ul>
    <li><a href="#rwt-launcher">Using the RWT Launcher</a></li>
    <li><a href="#rap-launcher">Using the RAP Launcher</a></li>
    <li><a href="#osgi-launcher">Using the OSGi Launcher</a></li>
    <li><a href="#troubleshooting">TroubleShooting</a></li>
  </ul>

  <h2><a name="rwt-launcher"></a>Using the RWT Launcher</h2>

  <p>
    The simplest way to launch an RWT application is to run it using an RWT Application launch 
    configuration. This launch configuration type uses information derived from the workbench 
    preferences and your applications's Java project to launch the program. 
  </p>
  <ol>
    <li>
      Select the Java class that contains the entry point you want to launch (e.g. in the
      <em class="UILabel">Package Explorer</em>).
    </li> 
    <li>
      Select <em class="UILabel">Run &gt; Run As &gt; RWT Application</em> in the workbench menu
      (or <em class="UILabel">Run As &gt; RWT Application</em> in the context menu of this file).
    </li>
    <li>
      The application will be launched and opened in a browser view.
    </li>
  </ol>
  <p>
    Before the RWT launcher starts an application, it terminates any possibly running
    instance of the same application.
    After a successful start, you should see a message like this one in the Console view:
    <br/>
    <code style="color:red">INFO: Started SocketListener on 0.0.0.0:&lt;port&gt;</code>.
  </p>

  <h3>Further configuration options</h3>

  <p>
    Whenever you start an application as described above, a <em>launch configuration</em> is
    created and added to the <em class="UILabel">Run &gt; Run History</em> menu.
    The created launch configuration is based on your Java project and your workbench preferences.
    It can later be edited and refined with custom or additional parameters.
  </p>

  <p>
    To create a new launch configuration or to alter an existing one, select
    <em class="UILabel">Run &gt; Run Configurations…</em> or
    <em class="UILabel">Run &gt; Debug Configurations…</em>.
    This opens a dialog that lets you create, modify, and delete launch configurations of different
    types.
    To create a new RWT Application launch configuration, select
    <em class="UILabel">RWT Application</em> from the list of launch configuration types on the
    left, and press the <em class="UILabel">New</em> button in the toolbar.
    The tabs on the right allow you control specific aspects of the launch.
  </p>

  <p>
    On the <em class="UILabel">Main</em> tab you can control the following aspects of the launch:
  </p>
  <ul>
    <li>
      The <em class="UILabel">Project</em> field denotes the project that contains the entry point
      to launch. You do not have to specify a project, but doing so allows a default classpath,
      source lookup path, and JRE to be chosen.
    </li>
    <li>
      The <em class="UILabel">Application entry point</em> lets you specify what should be launched.
      For simple use cases, choose <em class="UILabel">Run entry point class</em> and specify the
      class that implements the <code>IEntryPoint</code> interface in the class name field.
      <br/>
      If you need more control or even would like to run an arbitrary web application,
      select <em class="UILabel">Run from web.xml</em> and enter the path to the web.xml in the
      location field.
    </li>
    <li>
      In the <em class="UILabel">Runtime Settings</em>, you can select a fixed network port
      to start your application at.
      If you don't configure a port, the launcher will choose a free port.
    </li>
    <li>
      The <em class="UILabel">Browser</em> group lets you control whether the application should be
      opened in a browser after a successful start.
      The application can be opened either in an internal browser, i.e. embedded in the Eclipse IDE,
      or in an external browser.
      The external browser application can be configured in the <em>Web Browser</em> preference
      settings, the link <em class="UILabel">Configure browsers…</em> lets you jump right there.
    </li>
    <li>
      The <em class="UILabel">servlet path</em> is used to construct the URL to be opened with the
      browser.
      If you're launching an <em>entry point</em>, you are free to choose an arbitrary path.
      When launching an application from a <em>web.xml</em>, it must point to one of the servlets
      defined in the web.xml.
    </li>
  </ul>

  <p>
    For an explanation of the other tabs see the topic
    <a href="/help/topic/org.eclipse.jdt.doc.user/tasks/tasks-java-local-configuration.htm">Creating
      a Java application launch configuration</a>
  </p>

  <h2><a name="rap-launcher"></a>Using the RAP Launcher</h2>

  <p>
    The RAP Launcher is based on the
    <a href="/help/topic/org.eclipse.pde.doc.user/guide/tools/launchers/equinox_launcher.htm">OSGi Launcher</a>
    and adds a <em class="UILabel">Main</em> tab page to it.
    Please note that the RAP Launcher only works when the Equinox OSGi Framework is selected,
    which is the default setting on page <em class="UILabel">Bundles</em>.
  </p>

  <h3>Run in Browser</h3>
  <p>
    This setting lets you control whether the application should be opened in a browser after a
    successful start.
    The application can be opened either in an internal browser, i.e. embedded in the Eclipse IDE,
    or in an external browser.
    The external browser application can be configured in the <em>Web Browser</em> preference
    settings, the link <em class="UILabel">Configure browsers…</em> lets you jump right there.
  </p>
  <p>
    The <em class="UILabel">Servlet Path</em> and <em class="UILabel">Startup Parameter</em>
    fields let you configure the URL that will be opened in the browser.
    The startup parameter is considered obsolete.
    The entrypoint to start is normally configured using the servlet name.
  </p>

  <h3>Runtime Settings</h3>
  <p>
    <em class="UILabel">Manual Port configuration</em> lets you can select a fixed network port
    to start your application at.
    If you don't configure a port, the launcher will choose a free port.
  </p>
  <p>
    When the option <em class="UILabel">Terminate possible running previous launch</em> is selected,
    the launcher automatically stops an application with the same name that is currently running.
    This helps to restart applications quickly without having to stop the application before.
  </p>
  <p>
    <em class="UILabel">Session Timeout</em> specifies the servlet session timeout in seconds.
    If the checkbox is unselected, the session will never expire.
  </p>
  <p>
    <em class="UILabel">Context Path</em> selects an optional context path for the web application.
    The context path is part of a web application's URL, e.g.
    <em>http://server:port/contextPath/servletPath</em>.
    In a servlet container, every webapp is available at its own context path.
    This setting lets you simulate the same context path that your application will be accessible
    at in the production environment.
  </p>
  <p>
    The option <em class="UILabel">Client-side Library Variant</em> selects the variant of the
    RWT JavaScript library that will be delivered to the client.
    The <em>Standard</em> version is optimized for speed and size by compressing the JavaScript
    code.
    The <em>Debug</em> version maintains the JavaScript code in its original form.
    We recommend to use the Debug variant when developing custom widgets for RAP.
  </p>

  <h3>Instance Area</h3>
  <p>
    The instance area location sets the Program Arguments to define the
    <code><a href="/help/topic/org.eclipse.platform.doc.isv/reference/misc/runtime-options.html">
    osgi.instance.area</a></code>. Bundles use this location to store their state location 
    data.</p>

  <h3>Required plug-ins</h3>
  <p>
    In the Bundles tab, the following bundles need to be activated:
  </p>

  <p>
    <em>Basic RAP bundles</em>
  </p>
  <ul>
    <li>org.eclipse.rap.rwt</li>
    <li>org.eclipse.rap.rwt.osgi</li>
  </ul>

  <p>
    <em>Basic Equinox OSGi platform</em>
  </p>
  <ul>
    <li>org.eclipse.osgi</li>
    <li>org.eclipse.osgi.services</li>
    <li>org.eclipse.equinox.console (the OSGi console)
      <ul>
        <li>org.apache.felix.gogo.command (required by equinox.console)</li>
        <li>org.apache.felix.gogo.shell (required by equinox.console)</li>
        <li>org.apache.felix.gogo.runtime (required by equinox.console)</li>
      </ul>
    </li>
    <li>org.eclipse.equinox.http.jetty</li>
    <li>org.eclipse.equinox.http.servlet</li>
    <li>org.eclipse.equinox.ds (to enable declarative services)
      <ul>
        <li>org.eclipse.equinox.util (required by equinox.ds)</li>
      </ul>
    </li>
  </ul>

  <p>
    <em>The Jetty servlet container</em>
  </p>
  <ul>
    <li>org.eclipse.jetty.continuation</li>
    <li>org.eclipse.jetty.http</li>
    <li>org.eclipse.jetty.io</li>
    <li>org.eclipse.jetty.security</li>
    <li>org.eclipse.jetty.server</li>
    <li>org.eclipse.jetty.servlet</li>
    <li>org.eclipse.jetty.util</li>
  </ul>

  <p>
    <em>Servlet API (remove when deploying to a servlet container)</em>
  </p>
  <ul>
    <li>javax.servlet</li>
  </ul>

  <p>
    <em>Additional RAP bundles (require additional platform bundles - see below)</em>
  </p>
  <ul>
    <li>org.eclipse.rap.jface</li>
    <li>org.eclipse.rap.jface.databinding</li>
    <li>org.eclipse.rap.ui</li>
    <li>org.eclipse.rap.ui.forms</li>
    <li>org.eclipse.rap.ui.views</li>
    <li>org.eclipse.rap.ui.workbench</li>
  </ul>

  <p>
    <em>Eclipse platform bundles required by applications using JFace or the Workbench
   (only a subset may be required, please check for the actual dependencies)</em>
  </p>
  <ul>
    <li>com.ibm.icu.base</li>
    <li>org.eclipse.core.commands</li>
    <li>org.eclipse.core.contenttype</li>
    <li>org.eclipse.core.databinding</li>
    <li>org.eclipse.core.databinding.beans</li>
    <li>org.eclipse.core.databinding.observable</li>
    <li>org.eclipse.core.databinding.property</li>
    <li>org.eclipse.core.expressions</li>
    <li>org.eclipse.core.jobs</li>
    <li>org.eclipse.core.runtime</li>
    <li>org.eclipse.equinox.app</li>
    <li>org.eclipse.equinox.common</li>
    <li>org.eclipse.equinox.registry</li>
    <li>org.eclipse.equinox.preferences</li>
    <li>org.eclipse.equinox.http.registry</li>
  </ul>

  <p>
    To launch a once created launch configuration you may use the launch shortcut keys
    <em class="UILabel">Alt+Shift+X+R</em> (run) and <em class="UILabel">Alt+Shift+D+R</em> (debug).
  </p>

  <h2><a name="osgi-launcher"></a>Using the OSGi Launcher</h2>

  <p>
    Alternatively, you can also use the plain OSGi Launcher to start RAP applications.
    In this case, you have to set the necessary system properties and program arguments on your own.
    At least, you have to specify the HTTP port for the server with the VM argument
  </p>
  <pre><code>-Dorg.osgi.service.http.port=&lt;PORT&gt;</code></pre>
  <p>
    Tu run RAP in debug mode, add this system property, too:
  </p>
  <pre><code>-Dorg.eclipse.rwt.clientLibraryVariant=DEBUG</code></pre>

  <h3>Servlet engine log</h3>
  <p>
    By default the servlet engine (namely Jetty) is configured to suppress most logging 
    information. This can be changed by adding the VM argument
    <code>-Dorg.eclipse.equinox.http.jetty.log.stderr.threshold=&lt;log level&gt;</code> 
    to the launch configuration. Valid log levels are <code>debug</code>, 
    <code>info</code>, <code>warn</code>, <code>error</code>, and <code>off</code>.
    The default value is <code>warn</code>.
  </p>

  <h2><a name="troubleshooting"></a>TroubleShooting</h2>

  <ul>
    <li>
      <p>
        <b>Unsupported JRE version</b>
      </p>
      <p>
        <code style="color:red">java.lang.UnsupportedClassVersionError: Bad version number in .class file</code>
      </p>
      <p>
        The launcher requires JavaSE 1.6 or higher.
        If your project is configured with a JRE &lt; 1.6, the launcher will try to start with a
        matching JRE. If you have a 1.5 JRE configured in your IDE, it will fail with an exception
        like the one shown above.
        In this case, edit the launch configuration and set the JRE to a Java 6 or higher.
      </p>
    </li>
    <li>
      <p>
        <b>Unsupported Operation mode</b>
      </p>
      <p>
        <code style="color:red">java.lang.UnsupportedOperationException: The SimpleLifeCycle does not support Display#sleep()</code>
      </p>
      <p>
        The RWT launcher starts applications in the JEE compatibility mode.
        This mode does not support <code>Display.sleep()</code>, specifically, it does not support
        the SWT main loop. When starting an SWT snippet, this code block must be removed:
      </p>
      <pre><code>  while( !shell.isDisposed() ) {
    if( !display.readAndDispatch() )
      display.sleep();
  }
  display.dispose();</code></pre>
    </li>
  </ul>

</body>
</html>
